<?php
/**
 * Secrets Configuration Template
 *
 * Copy this file to .secrets.php and fill in your actual values.
 * 
 * SECURITY REQUIREMENTS:
 * - config/.secrets.php should NEVER be committed to version control
 * - Generate new keys using: php keygenerator.php
 * - Ensure proper file permissions (e.g., chmod 600 config/.secrets.php)
 * - config/.secrets.php is listed in .gitignore */

// ============================================================================
// ENCRYPTION KEY
// ============================================================================
// This key is used to encrypt/decrypt user IDs (UidEncryptor)
// 
// IMPORTANT: This must be a 32-byte key encoded in base64 with 'base64:' prefix
// 
// To generate a new key, run:
//   php -r "echo 'base64:' . base64_encode(random_bytes(32)) . PHP_EOL;"
//
// Example output:
//   base64:YourRandomBase64EncodedKeyHere1234567890ABCDEF==
//
putenv('ENCRYPTION_KEY=base64:REPLACE_WITH_YOUR_GENERATED_KEY');

// ============================================================================
// WEBLING API CONFIGURATION
// ============================================================================
// Domain: Your Webling subdomain (without .webling.ch)
// Example: If your Webling URL is https://mycompany.webling.ch, use 'mycompany'
//
putenv('WEBLING_DOMAIN=your-domain');

// API Key: Your Webling API key
// You can find this in your Webling settings under API
//
putenv('WEBLING_API_KEY=your-api-key-here');

// ============================================================================
// SMTP CONFIGURATION (for sending authentication codes via email)
// ============================================================================
// SMTP Server Host
// Example: smtp.gmail.com, smtp.office365.com, mail.example.com
//
putenv('SMTP_HOST=smtp.example.com');

// SMTP Server Port
// Common ports: 587 (TLS/STARTTLS), 465 (SSL), 25 (plain - not recommended)
//
putenv('SMTP_PORT=587');

// SMTP Username (usually your email address)
//
putenv('SMTP_USERNAME=your-email@example.com');

// SMTP Password
//
putenv('SMTP_PASSWORD=your-smtp-password');

// From Email Address (sender)
//
putenv('SMTP_FROM_EMAIL=noreply@example.com');

// From Name (optional, sender display name)
//
putenv('SMTP_FROM_NAME=Authentication Service');

// Use TLS encryption (true/false, default: true)
//
putenv('SMTP_USE_TLS=true');

// ============================================================================
// API KEYS CONFIGURATION
// ============================================================================
// Define API keys with their permissions.
// 
// To generate new API keys, run:
//   php -r "require 'keygenerator.php'; echo generateApiKey(32) . PHP_EOL;"
//
// Permissions:
// - 'user_info': Allows access to /user/{session_id}/info endpoint
// - 'user_token': Allows access to /user/{session_id}/token endpoint
//
// Default permissions (always allowed for valid API keys):
// - POST /login
// - POST /validate/{session_id}
// - GET /session/check/{session_id}
// - POST /session/touch/{session_id}
// - POST /session/logout/{session_id}
//
// IMPORTANT: Sessions can only be accessed by the same API key that created them
//
$API_KEYS = [
    'REPLACE_WITH_GENERATED_API_KEY_1' => [
        'name' => 'Main Application',
        'permissions' => ['user_info', 'user_token']
    ],
    'REPLACE_WITH_GENERATED_API_KEY_2' => [
        'name' => 'Limited Application',
        'permissions' => [] // Only default routes allowed
    ],
    'REPLACE_WITH_GENERATED_API_KEY_3' => [
        'name' => 'Info Only Application',
        'permissions' => ['user_info'] // Can access user info but not token
    ],
];

// ============================================================================
// SETUP INSTRUCTIONS
// ============================================================================
// 1. Copy this file: cp config/secrets.php.example config/.secrets.php
// 2. Generate encryption key: php -r "echo 'base64:' . base64_encode(random_bytes(32)) . PHP_EOL;"
// 3. Generate API keys: php -r "require 'keygenerator.php'; echo generateApiKey(32) . PHP_EOL;"
// 4. Edit config/.secrets.php and replace all placeholder values
// 5. Configure API key permissions according to your needs
// 6. Verify config/.secrets.php is in .gitignore
// 7. Set proper permissions: chmod 600 config/.secrets.php
